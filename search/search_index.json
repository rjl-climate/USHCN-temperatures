{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"US Historical Climatology Network (USHCN) Data","text":"<p>Is the weather getting worse?</p> <p>The U.S. Historical Climatology Network ( USHCN) is a dataset managed by the National Climatic Data Center (NCDC), which is part of the National Oceanic and Atmospheric Administration (NOAA). The USHCN provides high-quality, long-term temperature and precipitation data from various weather stations across the United States. This data is used to study climate trends and variations over time.</p> <p>It's not easy to analyse, so I wrote a tool for doing so which you can obtain from GitHub or crates.io.</p> <p>This repository contains python scripts for plotting processing USHCN datafiles to evaluate the claim of an upward trend in temperature. I've created it to make the data available, and to make the data source and methodology transparent.</p> <p>In these pages, you can find information for installing the data downloader tool, and installing the plotting scripts, so that you can recreate the analyses.</p>"},{"location":"contact/","title":"Contact","text":"<p>A core principle of this project is to be as open and transparent as possible. If you have any questions that aren't answered here, please don't hesitate to get in touch.</p> <p>You can reach me on twitter at @lyonphotographs</p> <p>```</p>"},{"location":"data_sources/","title":"Data Sources","text":"<p>The U.S. Historical Climatology Network ( USHCN) is a dataset managed by the National Climatic Data Center (NCDC), which is part of the National Oceanic and Atmospheric Administration (NOAA). The USHCN provides high-quality, long-term temperature and precipitation data from various weather stations across the United States. This data is used to study climate trends and variations over time. We can use this data to evaluate the climate catastrophe hypothesis.</p> <p>Data description : https://www.ncei.noaa.gov/pub/data/ushcn/v2.5/readme.txt</p> <p>Station data : https://www.ncei.noaa.gov/pub/data/ushcn/v2.5/ushcn-v2.5-stations.txt</p> <p>Daily data: https://www.ncei.noaa.gov/pub/data/ghcn/daily/</p> <p>Monthly data: https://www.ncei.noaa.gov/pub/data/ushcn/v2.5/</p>"},{"location":"installation/","title":"Installation","text":""},{"location":"installation/#downloader","title":"Downloader","text":"<p>To generate the plots, you'll need the USHCN datafiles. These are published by NOAA, but not in a form that can be used directly. So I've written a simple application to allow you to do it yourself.</p> <p>It's available here: crates.io.</p> <p>It's a terminal command line application, written in Rust. To use it, you'll need to install Rust, then install the application, then run it periodically.</p> <p>Here's how to install it. First, install rust:</p> <pre><code>&gt; curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\n</code></pre> <p>Then install the application:</p> <pre><code>&gt; cargo install ushcn\n</code></pre> <p>Then run it:</p> <pre><code>&gt; ushcn daily\n</code></pre> <p>That will download the latest datafiles from the USHCN FTP site and save them to your home directory.</p>"},{"location":"installation/#plotting-scripts","title":"Plotting scripts","text":"<p>To run the scripts yourself, download the repository from GitHub: https://github.com/rjl-climate/USHCN-temperatures/tree/main.</p> <p>Edit the script at <code>utils/data.py</code> and edit the variables <code>daily_parquet_file_path</code> and <code>monthly_parquet_file_path</code> to point to where you've downloaded the data (see above). Then you can run the scripts in the <code>plots</code> directory.</p>"},{"location":"plots/are_heatwaves_increasing/","title":"Are heatwaves increasing?","text":"<p>The New York Times and other sources claim that recent US heatwaves are not just a result of typical summer weather but are significantly influenced by climate change. Heatwaves are increasing frequency and intensity, they claim, and these increases are being driven by rising global temperatures. Climate change has made such extreme heat events more likely and more severe than they would have been without human impact.</p> <p>So. Are heatwaves increasing in the US?</p> <p>In this analysis, we define a heatwave as a period of at least 3 consecutive days where the temperature at a station is above 90th percentile of temperatures at that location. We then count the number of heatwave measurements per year and express it as a fraction of the total measurement in the year.</p> <p>As a confounding factor control measure, we remove all stations with less than 100 years of data.</p> <p>The number of heatwaves was highest in the 1930's, and has remained constant since then at around 3.5% of the total number of measurements each year.</p> <p></p> <pre><code>\"\"\"\nAre heatwaves increasing?\n\nIn this graph, we define heatwave as a sequence of 3 or more consecutive\ndays where the daily maximum temperature exceeds the 90th percentile for\nthat station. We then compute the percentage of heatwave days in each year.\n\"\"\"\n\nimport os\n\nfrom python_ushcn.utils.paths import image_path\nfrom python_ushcn.utils.data import daily_tmax\nimport matplotlib.pyplot as plt\n\nfrom python_ushcn.utils.plots import configure_plot\n\nfile_name = os.path.basename(__file__)\n\ndf = daily_tmax()\n\ndf[\"year\"] = df[\"date\"].dt.year\n\n# Remove stations that do not have 100 years of data\n# NOTE: Equates to about 32% of stations\n# TODO: Check \"at least 90% of daily data\"?\nreport_counts = df.groupby(\"id\").size()\nreport_counts_filtered = report_counts[report_counts &gt;= 365 * 100]\n\n# Compute the 90th percentile of daily maximum temperature for each station\ntmax_90 = df.groupby(\"id\")[\"tmax\"].quantile(0.9)\n\n# Map each station's 90th percentile temperature to its daily maximum temperatures\ndf[\"exceeds_90th\"] = df.groupby(\"id\")[\"tmax\"].transform(lambda x: x &gt; tmax_90[x.name])\n\n# Identify sequences of 3 or more consecutive days exceeding the 90th percentile\nheatwave_series = (\n    df.groupby(\"id\")[\"exceeds_90th\"]\n    .rolling(window=3)\n    .sum()\n    .reset_index(level=0, drop=True)\n)\ndf[\"heatwave\"] = heatwave_series &gt;= 3\n\n# Filter rows where 'heatwave' is True, indicating at least 3 consecutive days above the 90th percentile\nheatwave_events = df[df[\"heatwave\"]]\n\n# Compute the percentage of heatwave days in each year\nyear_count = df.groupby(\"year\").size()\nheatwave_year_count = heatwave_events.groupby(\"year\").size()\nheatwave_pcnt = 100 * heatwave_year_count / year_count\n\n# Convert to DataFrame and reset index for plotting\nheatwave_pcnt_df = heatwave_pcnt.reset_index(name=\"count\")\nprint(heatwave_pcnt_df.tail())\n\n# Plotting\n\ntitle = \"The number of heatwaves \\nis not increasing\"\nsubtitle = \"U.S. observed +3d / 90th percentile days\"\naxis_label = \"Percent\"\nsource = \"Source: US Historical Climatology Network, https://www.ncei.noaa.gov/pub/data/ushcn/v2.5/\"\n\nfig, ax = configure_plot(title, subtitle, axis_label, source)\nplt.plot(\n    heatwave_pcnt_df[\"year\"],\n    heatwave_pcnt_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.8,\n)\nplt.fill_between(\n    heatwave_pcnt_df[\"year\"],\n    heatwave_pcnt_df[\"count\"],\n    0,\n    color=\"tab:blue\",\n    alpha=0.1,\n)\n\n# Save\nimage_path = image_path(file_name)\nplt.savefig(image_path)\n\n# export to csv\ndf.to_csv(\"are_heatwaves_increasing.csv\")\n\n</code></pre>"},{"location":"plots/are_hotter_days_increasing/","title":"Are hotter days increasing ?","text":"<p>Hotter days are not increasing.</p> <p>The climate catastrophe hypothesis predicts that the number of hotter days should increase over time. They don't.</p> <p>In this graph, we plot the number of days that measurements exceed a measure of \"very hot\" as a percentage of all the measurements in that year. We've removed all of the stations that have less than 100 years of data to ensure that we remove that as a confounding factor.</p> <p></p>"},{"location":"plots/are_hotter_days_increasing/#script","title":"Script","text":"<pre><code>\"\"\"\nIs the number of very hot days increasing?\n\nThis script plots the number of days that maximum temperatures exceeds a\nthreshold in each year. We select stations that have data for the entire\nperiod from 1900 to 2024 to exclude the effect of station closures on the\ncount.\n\"\"\"\n\nimport os\n\nfrom python_ushcn.utils.paths import image_path\nfrom python_ushcn.utils.data import daily_tmax\nimport matplotlib.pyplot as plt\n\nfrom python_ushcn.utils.plots import configure_plot\n\nfile_name = os.path.basename(__file__)\n\ndf = daily_tmax()\n\n# Remove stations that do not have 100 years of data\n# NOTE: Equates to about 32% of stations\nreport_counts = df.groupby(\"id\").size()\nreport_counts_filtered = report_counts[report_counts &gt;= 365 * 100]\n\n# Filter the original DataFrame to only include stations with data for the required period\ndf = df[df[\"id\"].isin(report_counts_filtered.index)]\n\nmax_temp_95 = 35\nmax_temp_100 = 37.8\nmax_temp_105 = 40.6\n\n# Count the number of days that the maximum temperature exceeds the threshold for each year\ndf[\"count_95\"] = df[\"tmax\"] &gt; max_temp_95\ndf[\"count_100\"] = df[\"tmax\"] &gt; max_temp_100\ndf[\"count_105\"] = df[\"tmax\"] &gt; max_temp_105\n\n# Group by 'year' and sum the number of days that the maximum temperature exceeds the threshold\ndf[\"year\"] = df[\"date\"].dt.year\nyear_count = df.groupby(\"year\").size()\ncounts_95 = 100 * df.groupby(\"year\")[\"count_95\"].sum() / year_count\ncounts_100 = 100 * df.groupby(\"year\")[\"count_100\"].sum() / year_count\ncounts_105 = 100 * df.groupby(\"year\")[\"count_105\"].sum() / year_count\n\n# Convert to DataFrame and reset index for plotting\ncounts_95_df = counts_95.reset_index(name=\"count\")\ncounts_100_df = counts_100.reset_index(name=\"count\")\ncounts_105_df = counts_105.reset_index(name=\"count\")\n\n# Plotting\n\ntitle = \"The number of very hot days \\nis not increasing\"\nsubtitle = \"U.S. observed number of very hot days\"\naxis_label = \"Percent\"\nsource = \"Source: US Historical Climatology Network, https://www.ncei.noaa.gov/pub/data/ushcn/v2.5/\"\n\nfig, ax = configure_plot(title, subtitle, axis_label, source)\n\nplt.plot(\n    counts_95_df[\"year\"],\n    counts_95_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.5,\n    label=\"&gt; 95F\",\n)\nplt.fill_between(\n    counts_95_df[\"year\"],\n    counts_95_df[\"count\"],\n    counts_100_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.2,\n)\nplt.plot(\n    counts_100_df[\"year\"],\n    counts_100_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.7,\n    label=\"&gt; 100F\",\n)\nplt.fill_between(\n    counts_100_df[\"year\"],\n    counts_100_df[\"count\"],\n    counts_105_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.5,\n)\nplt.plot(\n    counts_105_df[\"year\"],\n    counts_105_df[\"count\"],\n    color=\"tab:blue\",\n    alpha=0.9,\n    label=\"&gt; 105F\",\n)\nplt.fill_between(\n    counts_105_df[\"year\"],\n    counts_105_df[\"count\"],\n    0,\n    color=\"tab:blue\",\n    alpha=0.9,\n)\n\n\nplt.legend()\n\n# Save\nimage_path = image_path(file_name)\nplt.savefig(image_path)\n\n</code></pre>"},{"location":"plots/daily_observations_falling/","title":"Are daily observations falling?","text":"<p>Daily observations are falling.</p> <p>Data from the US Historical Climatology Network is used to support the claim that the weather is changing for the worse. Given the implications of the claim, it's reasonable to assess the quality of the network.</p> <p>One way to do this is to look at the number of observations that are made each day.</p> <p></p> <p>The number of daily readings peaked around 1995 and are now rapidly declining.</p> <p>The interesting thing about this is that NOAA still reports data from the stations that no longer exist. These are phantom readings generated by algorithmically.</p>"},{"location":"plots/daily_observations_falling/#script","title":"Script","text":"<pre><code>\"\"\"\nAre the number of daily observations falling?\n\nThis script plots the number of daily observations recorded in the\nUSHCN to assess whether and how quickly they are falling.\n\"\"\"\n\nimport os\n\nfrom python_ushcn.utils.paths import image_path\nfrom python_ushcn.utils.data import daily_tmax\nimport matplotlib.pyplot as plt\n\nfrom python_ushcn.utils.plots import configure_plot\n\n\ndef do_plot():\n\n    file_name = os.path.basename(__file__)\n\n    df = daily_tmax()\n\n    # Group by 'date' and count the number of reports for each day\n    report_counts = df.groupby(\"date\").size()\n\n    # Drop the last rows, which are incomplete\n    report_counts = report_counts.iloc[:-60]\n\n    # Compute the rolling average\n    df = report_counts.to_frame(name=\"counts\")\n    window_size = 360\n    df[\"max_avg\"] = (\n        df[\"counts\"].rolling(window=window_size).mean().shift(-(window_size - 1))\n    )\n\n    # Plotting\n\n    title = \"Daily observations\\nare falling\"\n    subtitle = \"Number of daily observations\"\n\n    fig, ax = configure_plot(title, subtitle)\n\n    plt.plot(df.index, df[\"max_avg\"], color=\"tab:red\")\n    plt.plot(df.index, df[\"counts\"], color=\"grey\", alpha=0.3)\n\n    # Save\n    image_path = image_path(file_name)\n    plt.savefig(image_path)\n\n\nif __name__ == \"__main__\":\n    do_plot()\n\n</code></pre>"}]}